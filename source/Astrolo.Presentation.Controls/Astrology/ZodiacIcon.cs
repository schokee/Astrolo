using Astrolo.Astrology;

namespace Astrolo.Presentation.Controls.Astrology
{
    public class ZodiacIcon : Shape
    {
        private static Lazy<IReadOnlyDictionary<ZodiacSign, System.Windows.Media.Geometry>> Paths { get; }

        static ZodiacIcon()
        {
            Paths = new Lazy<IReadOnlyDictionary<ZodiacSign, System.Windows.Media.Geometry>>(() => new (ZodiacSign Sign, string Path)[]
                {
                    (ZodiacSign.Capricorn, "m 421.99805,262 c -34.334,0 -65.938,6.872 -94,20.198 V 118 c 0,-65.065 -52.935,-118 -118,-118 -33.395,0 -63.591,13.948 -85.078,36.32 C 114.03405,14.798 91.71905,0 65.99805,0 29.60495,0 -0.00205,29.607 -0.00205,66 v 40 h 40 V 66 c 0,-14.336 11.6641,-26 26.0001,-26 14.336,0 26,11.664 26,26 v 289 h 40 V 118 c 0,-43.009 34.991,-78 78,-78 43.009,0 78,34.991 78,78 v 189 c 0,0.176 0.01,0.35 0.01,0.526 -10.466,8.561 -20.194,18.286 -29.108,29.16 -36.691,44.756 -56.898,107.017 -56.898,175.314 h 40 c 0,-58.413 17.389,-117.113 54.425,-157.544 6.577,17.797 16.884,34.105 30.531,47.918 25.246,25.553 59,39.626 95.044,39.626 49.626,0 90,-40.374 90,-90 0,-49.626 -40.374,-90 -90,-90 z m 0,140 c -45.206,0 -83.057,-32.419 -91.997,-75.46 24.98,-15.459 55.531,-24.54 91.997,-24.54 27.57,0 50,22.43 50,50 0,27.57 -22.43,50 -50,50 z"),
                    (ZodiacSign.Aquarius, "m 334.90015,385.4926 -78.8997,-73.85406 -78.8997,73.85406 -78.8176,-73.77683 -70.6929,66.96801 -27.5903,-29.12381 98.1177,-92.94768 78.982,73.93129 78.8998,-73.85406 78.8997,73.85406 78.982,-73.93129 98.1178,92.94768 -27.5884,29.12381 -70.6928,-66.96801 z m 78.8177,-203.88071 70.6928,66.96702 27.5894,-29.12382 -98.1178,-92.94768 -78.982,73.9313 -78.8997,-73.85509 -78.8998,73.85509 -78.982,-73.9313 -98.1187,92.94768 27.5893,29.12382 70.6929,-66.96802 78.8175,73.77784 78.8998,-73.85407 78.8997,73.85407 z"),
                    (ZodiacSign.Pisces, "m 452.19625,419.3249 c -20.0122,-32.53129 -43.4905,-82.46109 -47.8452,-142.38959 h 70.4059 v -40.0705 h -70.3337 c 4.5269,-59.7502 27.9191,-110.0978 47.8782,-143.089804 24.4641,-40.4392 49.3609,-64.609701 49.6093,-64.849101 L 488.03535,14.473405 474.18195,5e-6 c -1.144,1.0939 -28.3148,27.317 -55.4756,71.898501 -32.1215,52.723804 -50.7463,109.342404 -54.4468,164.966304 h -216.519 C 144.04005,181.24191 125.41525,124.62231 93.29375,71.898506 66.13295,27.317005 38.96205,1.093905 37.81805,5e-6 l -27.7288,28.9259 c 0.2485,0.2394 25.1453,24.409901 49.6093,64.849101 19.9592,32.992004 43.3513,83.339604 47.8783,143.089804 h -69.5875 v 40.0705 h 69.6606 c -4.3546,59.9285 -27.833,109.8583 -47.8452,142.38959 -24.4099,39.6788 -49.2536,63.111 -49.479,63.32139 L 37.60275,512 c 1.147,-1.0659 28.3949,-26.6008 55.6108,-70.51311 32.3439,-52.18579 51.0248,-108.68228 54.5861,-164.55159 h 216.4008 c 3.5613,55.86931 22.2421,112.36571 54.5861,164.55159 27.2148,43.9113 54.4638,69.44721 55.6108,70.51311 l 27.3011,-29.3316 c -0.2485,-0.2325 -25.0922,-23.6647 -49.5022,-63.3435 z"),
                    (ZodiacSign.Aries, "m 374,5e-6 c -49.941,0 -93.771,26.666 -118,66.50803 C 231.771,26.666005 187.941,5e-6 138,5e-6 61.906,5e-6 0,61.907035 0,138.00004 c 0,76.09299 61.906,138 138,138 v -40 c -54.037,0 -98,-43.963 -98,-98 0,-54.037005 43.963,-98.000005 98,-98.000005 54.037,0 98,43.963 98,98.000005 V 512 h 40 V 138.00004 c 0,-54.037005 43.963,-98.000005 98,-98.000005 54.037,0 98,43.963 98,98.000005 0,54.037 -43.963,98 -98,98 v 40 c 76.094,0 138,-61.90701 138,-138 C 512,61.907035 450.094,5e-6 374,5e-6 Z"),
                    (ZodiacSign.Taurus, "M 511.51715,27.4626 482.24085,0.213 c -0.231,0.248 -23.619,25.0448 -63.224,49.4087 -35.7784,22.0102 -94.0472,48.4308 -162.1185,48.4308 -68.9913,0 -126.6179,-26.6375 -162.8173,-48.5367 C 53.71815,25.0979 29.59315,0.248 29.35425,0 L 0.48285,27.6775 c 1.0929,1.1419 27.2666,28.2614 71.7629,55.3709 27.8965,16.9958 56.8868,30.2042 86.2401,39.42 -65.1307,34.9026 -109.5361,103.6378 -109.5361,182.5578 0,114.1255 92.8472,206.9738 206.9737,206.9738 114.1266,0 206.9738,-92.8483 206.9738,-206.9738 0,-78.555 -43.9914,-147.0263 -108.6312,-182.0789 29.6883,-9.2488 58.9016,-22.6431 86.872,-39.9789 43.8284,-27.1644 69.3152,-54.362 70.3791,-55.5058 z m -88.6148,277.5636 c 0,92.0723 -74.9065,166.9788 -166.9789,166.9788 -92.0723,0 -166.9788,-74.9065 -166.9788,-166.9788 0,-91.6553 76.4523,-166.9788 167.9547,-166.9788 91.9874,0 166.003,75.7354 166.003,166.9788 z"),
                    (ZodiacSign.Gemini, "m 441.19495,429.00622 c -26.2118,-16.246 -53.5148,-29.0293 -81.2769,-38.188 V 121.76083 c 27.7821,-9.22669 55.1031,-22.10905 81.332,-38.48106 43.841,-27.36502 69.3307,-54.76005 70.3949,-55.91326 L 482.26355,0.21352 c -0.2311,0.25005 -23.6284,25.23364 -63.2446,49.78014 -35.9486,22.27309 -93.1771,48.82397 -161.6637,48.82397 -68.5746,0 -126.6393,-26.60889 -163.274,-48.93099 C 53.70585,25.28613 29.57245,0.24953 29.33435,-5.2e-4 L 0.35505,27.58255 c 1.0922,1.14921 27.27,28.46722 71.7802,55.77924 25.8357,15.85291 52.6106,28.43922 79.7446,37.5889 v 270.67273 c -27.1149,9.0816 -53.8709,21.5719 -79.6906,37.3028 -44.5112,27.118 -70.693,54.246 -71.7852,55.3882 l 28.8803,27.6861 c 0.2391,-0.2481 24.3715,-25.1057 64.7469,-49.5311 36.6427,-22.1691 94.7234,-48.594 163.324,-48.594 68.5126,0 125.7561,26.3679 161.7127,48.4879 39.6163,24.3715 63.0116,49.1761 63.2216,49.4011 l 29.3074,-27.234 c -1.0642,-1.1462 -26.5589,-28.3522 -70.402,-55.5242 z m -249.3077,-48.2408 V 131.88069 c 21.871,4.59385 43.792,6.94328 65.468,6.94328 20.7698,0 41.7077,-2.1604 62.5555,-6.38117 v 247.76252 c -20.8488,-4.1928 -41.7857,-6.3392 -62.5555,-6.3392 -21.675,0 -43.596,2.3354 -65.468,6.8993 z"),
                    (ZodiacSign.Cancer, "m 84.2409,76.020075 c 33.3827,-16.36958 86.8917,-35.88316 152.234,-35.88316 44.6666,0 87.7352,10.6912 128.3923,31.80575 -57.3545,10.8331 -100.8738,61.306975 -100.8738,121.763475 0,33.09293 12.9128,64.11717 36.3589,87.35537 23.3571,23.15126 54.4543,35.90014 87.5622,35.90014 33.1079,0 64.2051,-12.74888 87.5623,-35.90014 23.446,-23.2382 36.3588,-54.26144 36.3588,-87.35537 0,-33.47868 -13.3505,-63.89431 -35.0007,-86.2161 l 0.01,-0.006 c -0.9424,-1.11529 -23.55,-27.629415 -64.2951,-53.997625 -53.9036,-34.88478 -114.7889,-53.32404 -176.0729,-53.32404 -73.6551,0 -133.7488,22.09693 -171.1919,40.63512 C 24.4829,60.998635 0.9819,81.364665 0.0015,82.221125 L 26.2798,112.34495 C 26.4897,112.16306 47.6932,93.942655 84.2439,76.020075 Z M 387.9145,276.98611 c -46.2885,0 -83.9465,-37.35921 -83.9465,-83.27997 0,-46.28852 37.658,-83.94655 83.9465,-83.94655 46.2885,0 83.9466,37.65803 83.9466,83.94655 0,45.92076 -37.6581,83.27997 -83.9466,83.27997 z M 485.7202,399.654 c -0.2098,0.18189 -21.4133,18.40229 -57.964,36.32487 -33.3828,16.36958 -86.8917,35.88316 -152.2341,35.88316 -44.3947,0 -87.3564,-10.71018 -128.0855,-31.86471 57.2026,-10.95503 100.566,-61.35594 100.566,-121.70351 0,-33.09293 -12.9128,-64.11718 -36.3588,-87.35537 -23.3572,-23.15126 -54.4544,-35.90014 -87.5623,-35.90014 -33.1079,0 -64.2051,12.74888 -87.5622,35.90014 -23.4461,23.23819 -36.3589,54.26144 -36.3589,87.35537 0,32.8231 12.8328,62.70207 33.7375,84.89694 l -0.023,0.02 c 0.9554,1.12828 23.8589,27.93721 64.8917,54.61922 54.3354,35.3315 115.4565,54.00765 176.7555,54.00765 73.6551,0 133.7488,-22.09796 171.192,-40.63515 40.803,-20.20115 64.304,-40.56719 65.2844,-41.42465 z M 124.0825,235.01284 c 46.2885,0 83.9466,37.35921 83.9466,83.27998 0,46.28851 -37.6581,83.94655 -83.9466,83.94655 -46.2885,0 -83.9465,-37.65804 -83.9465,-83.94655 0,-45.92077 37.658,-83.27998 83.9465,-83.27998 z"),
                    (ZodiacSign.Leo, "m 472,429.99848 c 0,11.322 -4.438,21.938 -12.497,29.893 -8.056,7.952 -18.716,12.207 -30.067,12.104 -22.848,-0.297 -41.436,-19.551 -41.436,-42.921 v -339.076 c 0,-49.626 -40.374,-90 -90,-90 -49.626,0 -90,40.374 -90,90 v 206.874 c -22.108,-20.395 -51.622,-32.874 -84,-32.874 -68.374,0 -124,55.626 -124,124 0,68.374 55.626,124.00004 124,124.00004 68.374,0 124,-55.62604 124,-124.00004 v -298 c 0,-27.57 22.43,-50 50,-50 27.57,0 50,22.43 50,50 v 339.076 c 0,45.142 36.299,82.33804 80.917,82.91704 0.367,0.01 0.731,0.01 1.098,0.01 21.705,-10e-4 42.12,-8.371 57.589,-23.64104 15.732,-15.529 24.396,-36.255 24.396,-58.359 z m -348,42 c -46.318,0 -84,-37.682 -84,-84 0,-46.318 37.682,-84 84,-84 46.318,0 84,37.682 84,84 0,46.318 -37.682,84 -84,84 z"),
                    (ZodiacSign.Virgo, "m 442.868,438.198 c -7.103,-8.836 -13.581,-19.5 -19.409,-31.919 10.615,-11.938 20.462,-24.471 29.462,-37.563 C 491.019,313.3 512,250.794 512,192.714 c 0,-22.296 -8.739,-43.203 -24.608,-58.867 -15.867,-15.663 -36.891,-24.15 -59.198,-23.839 -16.203,0.21 -31.319,5.111 -44.089,13.363 C 384.002,108.92 384,95.244 384,82.714 384,60.418 375.261,39.511 359.392,23.847 343.525,8.184 322.529,-0.263 300.194,0.007 275.451,0.328 253.244,11.673 238.163,29.304 222.939,11.394 200.28,0 175,0 152.348,0 131.796,9.146 116.814,23.932 104.698,9.322 86.418,0 66,0 29.607,0 0,29.607 0,66 v 40 H 40 V 66 C 40,51.664 51.664,40 66,40 80.336,40 92,51.664 92,66 v 330 h 40 V 83 h 0.072 c 0,-23.71 19.257,-43 42.928,-43 23.671,0 42.928,19.29 42.928,43.009 l 0.144,312.928 40,-0.019 -0.144,-312.27 H 258 c 0,-23.76 19.161,-43.339 42.712,-43.645 11.538,-0.165 22.386,4.222 30.579,12.31 C 339.486,60.404 344,71.2 344,82.714 V 193 c 2.105,53.082 8.569,110.29 19.751,159.289 3.73,16.346 7.999,31.316 12.837,45.001 -30.819,30.33 -69.393,57.364 -116.179,77.76 l 15.985,36.667 c 43.966,-19.167 83.569,-44.712 117.388,-75.454 5.47,9.955 11.43,18.939 17.911,26.999 C 437.695,495.602 471.443,512 512,512 v -40 c -28.232,0 -50.845,-11.057 -69.132,-33.802 z M 428.712,150.004 c 11.541,-0.196 22.385,4.222 30.579,12.31 8.195,8.09 12.709,18.886 12.709,30.4 0,51.207 -20.723,113.628 -64.416,169.79 -1.712,-6.124 -3.325,-12.496 -4.835,-19.115 -10.493,-45.981 -15.112,-99.877 -17.146,-150.89 0.636,-22.856 20.111,-42.197 43.109,-42.495 z"),
                    (ZodiacSign.Libra, "m 5e-5,471.99999 h 511.9999 v 40 H 5e-5 Z M 511.99995,375 v 40 H 5e-5 v -40 h 135.71 c -52.176,-37.62 -86.21,-98.907 -86.21,-168 C 49.50005,92.860005 142.35905,5e-6 256.49995,5e-6 c 114.141,0 207,92.86 207,206.999995 0,69.093 -34.034,130.38 -86.21,168 z m -255.5,-1 c 92.084,0 167,-74.916 167,-167 0,-92.084 -74.916,-166.999995 -167,-166.999995 -92.0839,0 -166.9999,74.915995 -166.9999,166.999995 0,92.084 74.916,167 166.9999,167 z"),
                    (ZodiacSign.Scorpio, "m 471.9569,372.0254 v 78.3614 c -10.9248,-5.3269 -20.6878,-13.1294 -29.4251,-23.4883 -17.0266,-20.187 -30.4349,-50.529 -39.8521,-90.1791 C 383.9745,257.9631 383.9745,156.6623 383.9745,82.695002 383.9745,60.403502 375.2372,39.5007 359.3714,23.8398 343.5075,8.1799 322.4787,-0.2654 300.1852,0.0045 275.4621,0.3255 253.2715,11.6542 238.1935,29.2637 222.9595,11.3753 200.2981,-0.0025 175.0161,-0.0025 c -22.6475,0 -43.1954,9.1442 -58.1744,23.9263 C 104.7281,9.3177 86.4517,-0.0025 66.0378,-0.0025 29.6521,-0.0025 0.051,29.5986 0.051,65.984402 V 105.9764 H 40.043 V 65.984402 c 0,-14.3332 11.6617,-25.994802 25.9948,-25.994802 14.3332,0 25.9948,11.661602 25.9948,25.994802 V 395.9187 h 39.9921 V 82.981002 h 0.072 c 0,-23.7053 19.253,-42.991402 42.9194,-42.991402 23.7053,0 42.9915,19.286102 42.9915,42.991402 V 395.9187 h 39.992 V 83.629902 c 0,-23.7553 19.1572,-43.330402 42.7045,-43.636302 0.1899,0 0.3799,0 0.5708,0 11.3108,0 21.9457,4.3591 30.0011,12.311502 8.1932,8.0884 12.7064,18.8822 12.7064,30.3939 0,75.942898 0,179.951198 19.7871,263.265598 11.0308,46.4438 26.7947,81.3528 48.1923,106.7227 6.1578,7.3006 12.7546,13.7363 19.7662,19.3232 h -59.7511 v 39.992 H 511.949 v -12.9574 -39.992 -87.0227 h -39.9921 z"),
                    (ZodiacSign.Sagittarius, "m 264.57645,-5e-6 v 39.9901 h 178.7426 l -209.9789,210.418805 -75.5943,-75.5942 -28.278,28.277 75.6243,75.6242 -204.6073,205.03713 28.308,28.24698 204.5773,-205.00611 76.0531,76.0531 28.278,-28.27701 -76.0831,-76.0831 209.9069,-210.347795 V 256.93629 h 39.9901 V -5.0000002e-6 Z")
                }
                .ToDictionary(x => x.Sign, x => System.Windows.Media.Geometry.Parse(x.Path)));
        }

        public static readonly DependencyProperty SignProperty = DependencyProperty.Register(
            nameof(Sign), typeof(ZodiacSign), typeof(ZodiacIcon), new PropertyMetadata(default(ZodiacSign), OnValueChanged));

        public ZodiacSign Sign
        {
            get => (ZodiacSign)GetValue(SignProperty);
            set => SetValue(SignProperty, value);
        }

        protected override System.Windows.Media.Geometry DefiningGeometry => GetGeometry();

        private static void OnValueChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            ((ZodiacIcon)d).InvalidateVisual();
        }

        private System.Windows.Media.Geometry GetGeometry()
        {
            return Paths.Value.TryGetValue(Sign, out var path) ? path : new PathGeometry();
        }
    }
}
