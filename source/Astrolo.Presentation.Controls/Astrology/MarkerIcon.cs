using Astrolo.Astrology;

namespace Astrolo.Presentation.Controls.Astrology
{
    using Geometry = System.Windows.Media.Geometry;

    public sealed class MarkerIcon : Shape
    {
        private static Lazy<IReadOnlyDictionary<Marker, Geometry>> Paths { get; }

        static MarkerIcon()
        {
            Paths = new Lazy<IReadOnlyDictionary<Marker, Geometry>>(() => new (Marker Marker, string Path)[]
                {
                    (Marker.Sun, "M 28.097127,14.178273 A 12.828937,12.828937 0 0 1 15.26819,27.007209 12.828937,12.828937 0 0 1 2.439253,14.178273 12.828937,12.828937 0 0 1 15.26819,1.3493358 12.828937,12.828937 0 0 1 28.097127,14.178273 Z m -11.137267,0 a 1.6916699,1.6916699 0 0 1 -1.69167,1.69167 1.6916699,1.6916699 0 0 1 -1.69167,-1.69167 1.6916699,1.6916699 0 0 1 1.69167,-1.69167 1.6916699,1.6916699 0 0 1 1.69167,1.69167 z"),
                    (Marker.Earth, "M 15.26819 26.509272 V 1.3738524 M 2.70048 13.941562 H 27.8359 m 0.261225 0 A 12.828937 12.828937 0 0 1 15.268188 26.770498 12.828937 12.828937 0 0 1 2.4392519 13.941562 12.828937 12.828937 0 0 1 15.268188 1.1126257 12.828937 12.828937 0 0 1 28.097125 13.941562 Z"),
                    (Marker.NorthNode, "m 24.756264 23.491031 a 3.0735989 3.0735989 0 0 0 -3.073599 -3.073599 3.0735989 3.0735989 0 0 0 -3.073599 3.073599 3.0735989 3.0735989 0 0 0 3.073599 3.073599 3.0735989 3.0735989 0 0 0 3.073599 -3.073599 z m -4.420065 -2.807726 c 3.97299 -2.29106 5.90999 -6.96178 4.722631 -11.3877696 -1.187363 -4.42599 -5.203021 -7.50362 -9.790639 -7.50362 -4.587618 0 -8.603276 3.07763 -9.790638 7.50362 -1.187364 4.4259896 0.749636 9.0967196 4.722631 11.3877796 m 1.860776 2.807716 A 3.0735989 3.0735989 0 0 0 8.987361 20.417432 3.0735989 3.0735989 0 0 0 5.9137621 23.491031 3.0735989 3.0735989 0 0 0 8.987361 26.56463 3.0735989 3.0735989 0 0 0 12.06096 23.491031 Z"),
                    (Marker.SouthNode, "M 24.756264 4.8655092 A 3.0735989 3.0735989 0 0 1 21.682665 7.939108 3.0735989 3.0735989 0 0 1 18.609066 4.8655092 3.0735989 3.0735989 0 0 1 21.682665 1.7919103 3.0735989 3.0735989 0 0 1 24.756264 4.8655092 Z m -4.420065 2.8077262 c 3.97299 2.29106 5.90999 6.9617796 4.722631 11.3877696 -1.187363 4.42599 -5.203021 7.50362 -9.790639 7.50362 -4.587618 0 -8.603276 -3.07763 -9.790638 -7.50362 C 4.290189 14.635015 6.227189 9.9642854 10.200184 7.6732254 M 12.06096 4.8655092 A 3.0735989 3.0735989 0 0 1 8.987361 7.939108 3.0735989 3.0735989 0 0 1 5.9137621 4.8655092 3.0735989 3.0735989 0 0 1 8.987361 1.7919103 3.0735989 3.0735989 0 0 1 12.06096 4.8655092 Z"),
                    (Marker.Moon, "M 10.412267 1.3493396 A 12.828937 12.828937 0 0 0 7.2832595 1.7400126 12.828937 12.828937 0 0 1 16.972074 14.17853 12.828937 12.828937 0 0 1 7.2837755 26.617047 12.828937 12.828937 0 0 0 10.423636 27.007205 12.828937 12.828937 0 0 0 23.252827 14.17853 12.828937 12.828937 0 0 0 10.423636 1.3493396 a 12.828937 12.828937 0 0 0 -0.01138 0 z"),
                    (Marker.Mercury, "m 20.360416 11.704211 a 5.0922213 5.1737833 0 0 1 -5.092221 5.173784 5.0922213 5.1737833 0 0 1 -5.092221 -5.173784 5.0922213 5.1737833 0 0 1 5.092221 -5.1737824 5.0922213 5.1737833 0 0 1 5.092221 5.1737824 z M 10.121795 22.061896 h 10.29279 m -5.14639 -4.528251 v 9.702033 m 5.09222 -26.1148114 c 0 1.848415 -0.97057 3.55642 -2.54611 4.480628 -1.57554 0.924207 -3.51668 0.924207 -5.09222 0 -1.57554 -0.924208 -2.54611 -2.632213 -2.54611 -4.480628"),
                    (Marker.Venus, "M 21.549027 7.5701014 A 6.2808332 6.2808332 0 0 1 15.268194 13.850934 6.2808332 6.2808332 0 0 1 8.987361 7.5701014 6.2808332 6.2808332 0 0 1 15.268194 1.2892682 6.2808332 6.2808332 0 0 1 21.549027 7.5701014 Z M 8.92054 20.786445 h 12.6953 m -6.34765 -6.548104 v 12.828936"),
                    (Marker.Mars, "m 19.144006 1.8334398 7.866789 0.285162 0.285146 7.866758 m -7.091084 7.5821142 a 8.4822102 8.4822102 0 0 1 -8.48221 8.48221 8.4822102 8.4822102 0 0 1 -8.4822104 -8.48221 8.4822102 8.4822102 0 0 1 8.4822104 -8.4822101 8.4822102 8.4822102 0 0 1 8.48221 8.4822101 z m -2.261556 -6.381375 9.067494 -9.0674972"),
                    (Marker.Jupiter, "m 6.7168895 1.3356471 c 3.156653 0 6.0735215 1.648491 7.6518485 4.32451 1.578324 2.67602 1.578324 5.9730029 0 8.6490239 -1.578327 2.676019 -4.4951955 4.32451 -7.6518485 4.32451 m 0 6.5e-5 H 23.81949 m -4.088058 -8.387141 v 16.774283"),
                    (Marker.Saturn, "m 20.102552 18.197699 -1.275947 3.454957 m 7.266838 3.110386 a 3.9521096 4.0185523 19.667115 0 1 -3.181396 2.448376 3.9521096 4.0185523 19.667115 0 1 -3.647761 -1.561332 3.9521096 4.0185523 19.667115 0 1 -0.437682 -3.99743 M 9.5417786 14.971311 a 5.5585084 5.6462536 19.667115 0 1 4.0404124 -4.443919 5.5585084 5.6462536 19.667115 0 1 5.668239 1.731686 5.5585084 5.6462536 19.667115 0 1 0.852123 5.938621 M 4.4429383 5.7588471 H 14.735733 m -5.1463996 -4.6462214 -3e-7 20.6748003"),
                    (Marker.Uranus, "m 27.243 16.974772 c -2.6972 0 -5.18952 -1.352592 -6.53813 -3.548271 -1.3486 -2.195683 -1.3486 -4.900865 0 -7.096546 C 22.05348 4.134275 24.5458 2.781683 27.243 2.781683 M 3.2935 16.974772 c 2.6972 0 5.18952 -1.352592 6.53813 -3.548271 1.3486 -2.195683 1.3486 -4.900865 0 -7.096546 C 8.48302 4.134275 5.9907 2.781683 3.2935 2.781683 m 8.09151 7.096545 h 7.19039 m 0.983263 12.629483 a 4.2904129 4.361342 0 0 0 -4.290413 -4.361342 4.2904129 4.361342 0 0 0 -4.290412 4.361342 4.2904129 4.361342 0 0 0 4.290412 4.361342 4.2904129 4.361342 0 0 0 4.290413 -4.361342 z M 15.26825 17.702015 V 1.4874934"),
                    (Marker.Neptune, "m 22.59103 6.1814661 3.49643 -3.251819 3.49642 3.25182 m -17.81211 -1e-6 3.49643 -3.251819 3.49642 3.25182 m -17.81212001 -1e-6 3.49643001 -3.251819 3.49642 3.25182 m 18.14211 -2.424927 c 0 4.014491 -2.06214 7.7240309 -5.40963 9.7312789 -3.3475 2.007244 -7.47176 2.007244 -10.81927 0 C 6.51106 11.480571 4.44893 7.7710311 4.44893 3.7565401 M 10.1218 20.601386 H 20.41459 M 15.26819 4.8870371 V 25.775171"),
                    (Marker.Pluto, "m 25.07886 6.3781854 c 0 3.8465896 -1.8699 7.4009896 -4.905335 9.3242996 -3.035436 1.92327 -6.775235 1.92327 -9.810669 0 C 7.3274195 13.779175 5.4575195 10.224775 5.4575195 6.3781854 M 21.415498 7.1953618 A 6.1473083 6.2428617 0 0 1 15.268189 13.438223 6.1473083 6.2428617 0 0 1 9.1208811 7.1953618 6.1473083 6.2428617 0 0 1 15.268189 0.95249999 6.1473083 6.2428617 0 0 1 21.415498 7.1953618 Z M 10.121796 22.230265 h 10.292789 m -5.146395 -4.52825 v 9.70203")
                }
                .ToDictionary(x => x.Marker, x => Geometry.Parse(x.Path)));
        }

        public static readonly DependencyProperty MarkerProperty = DependencyProperty.Register(
            nameof(Marker), typeof(Marker), typeof(MarkerIcon), new PropertyMetadata(default(Marker), OnValueChanged));

        public Marker Marker
        {
            get => (Marker)GetValue(MarkerProperty);
            set => SetValue(MarkerProperty, value);
        }

        protected override Geometry DefiningGeometry => GetGeometry();

        private static void OnValueChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            ((MarkerIcon)d).InvalidateVisual();
        }

        private Geometry GetGeometry()
        {
            return Paths.Value.TryGetValue(Marker, out var path) ? path : new PathGeometry();
        }
    }
}
